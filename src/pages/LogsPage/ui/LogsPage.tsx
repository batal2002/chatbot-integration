import { FC, useEffect, useMemo, useState } from 'react';
import { useLocation, useNavigate, useParams } from 'react-router-dom';
import s from './LogsPage.module.scss';
import { LogsHeader } from '@/widgets/LogsHeader';
import { logListItem } from '@/shared/model/types/logListItem';
import { LogWindow } from '@/widgets/LogWindow';
import { LogItem } from '@/entities/LogItem';
import { useScreenDetector } from '@/shared/lib/hooks/useScreenDetector';
import { RightSideModal } from '@/shared/ui/RightSideModal/RightSideModal';

const dialogList: logListItem[] = [
    {
        id: 0,
        clientMessage:
            'ÐšÐ°ÐºÐ¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹ Ð¼Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð¸Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€ÐµÐ´ Ð¿ÐµÑ€Ð²Ñ‹Ð¼ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ð¼ Ð´Ð½ÐµÐ¼?',
        botMessage:
            'ÐŸÐµÑ€ÐµÐ´ Ñ‚Ð²Ð¾Ð¸Ð¼ Ð¿ÐµÑ€Ð²Ñ‹Ð¼ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ð¼ Ð´Ð½ÐµÐ¼, Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÑŽ Ð¾Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¸Ñ‚ÑŒÑÑ Ñ Ð²Ð²Ð¾Ð´Ð½Ñ‹Ð¼ ÐºÑƒÑ€ÑÐ¾Ð¼ Ð¾ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸, Ð¿Ñ€Ð¾Ð¹Ñ‚Ð¸ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾ ÐºÐ¾Ñ€Ð¿Ð¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ ÑÑ‚Ð¸ÐºÐµ Ð¸ Ð¾Ð·Ð½Ð°ÐºÐ¾Ð¼Ð¸Ñ‚ÑŒÑÑ Ñ ÐºÐ¾Ð»Ð»ÐµÐ³Ð°Ð¼Ð¸ Ð² Ð¾Ð½Ð»Ð°Ð¹Ð½-Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ðµ.\n' +
            'ÐšÑƒÑ€ÑÑ‹ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð°Ð¹Ñ‚Ð¸ Ð½Ð° Ð½Ð°ÑˆÐµÐ¼ ÐºÐ¾Ñ€Ð¿Ð¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¼ Ñ€ÐµÑÑƒÑ€ÑÐµ ÐŸÐ¾Ñ€Ñ‚Ð°Ð» Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²',
        date: new Date(),
    },
    {
        id: 1,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('2024-04-24T12:34:09'),
    },
    {
        id: 2,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('2024-04-24T02:34:09'),
    },
    {
        id: 3,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('12.02.2023'),
    },
    {
        id: 4,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('12.02.2023'),
    },
    {
        id: 5,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('12.02.2023'),
    },
    {
        id: 6,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('12.02.2023'),
    },
    {
        id: 7,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('12.02.2023'),
    },
    {
        id: 8,
        clientMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        botMessage:
            'ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐÐ°ÑÑ‡ÐµÑ‚ Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°. ÐŸÑ€ÐµÐ´Ð»Ð°Ð³Ð°ÑŽ ÑÐµÐ³Ð¾Ð´Ð½Ñ ÑÐ¾Ð·Ð²Ð¾Ð½Ð¸Ñ‚ÑŒÑÑ Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ð¾Ð»Ð¾Ð²Ð¸Ð½Ðµ Ð´Ð½Ñ Ð¸ Ð¾Ð±ÑÑƒÐ´Ð¸Ñ‚ÑŒ ðŸ˜Š',
        date: new Date('12.02.2023'),
    },
];

export const LogsPage: FC = () => {
    const navigate = useNavigate();
    const { chatbotId, logsId } = useParams();
    const { pathname } = useLocation();
    const { isTablet } = useScreenDetector();
    const [open, setOpen] = useState(false);

    const currentPathname = useMemo(
        () => pathname.split('/').pop(),
        [pathname],
    );

    useEffect(() => {
        if (
            (currentPathname === 'logs' || currentPathname === '') &&
            !isTablet
        ) {
            navigate(
                `/chatbot/${chatbotId}/dashboard/logs/${dialogList[0].id.toString()}`,
            );
        }
    }, [chatbotId, isTablet, navigate, currentPathname]);

    useEffect(() => {
        setOpen(!!logsId);
    }, [logsId]);

    const renderLogWindow = () => {
        if (isTablet) {
            return (
                <RightSideModal
                    withBottomNavigation
                    onClose={() =>
                        navigate(`/chatbot/${chatbotId}/dashboard/logs/`)
                    }
                    open={open}
                    title="Ð›Ð¾Ð³ 15.02.2024 13:00"
                >
                    <LogWindow />
                </RightSideModal>
            );
        }
        return <LogWindow />;
    };

    return (
        <div className={s.LogsPage}>
            <LogsHeader />

            <div className={s.wrapper}>
                <div className={s.dialogListWrapper}>
                    <div className={s.dialogList}>
                        {dialogList.map((dialog) => (
                            <LogItem key={dialog.id} {...dialog} />
                        ))}
                    </div>
                </div>
                {logsId && renderLogWindow()}
            </div>
        </div>
    );
};
